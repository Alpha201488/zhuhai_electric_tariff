# 珠海电价（HACS 集成）README

## 📌 简介

本集成（`zhuhai_energy_price`）用于在 Home Assistant 中生成珠海地区的实时电价、分时电价、以及阶梯电价计算展示。支持 HACS 安装、前端可视化配置（`config_flow`），并提供多个可用的电价传感器。

可用于：

* 显示当前时段电价（尖 / 峰 / 平 / 谷）。
* 根据当日用电量计算当日费用。
* 根据当月累计用电量计算阶梯电价。
* 在 Energy Dashboard 中使用。

---

## 📦 包含组件

* `sensor.py` — 电价、当日费用、当月费用等传感器。
* `config_flow.py` — 前端图形化配置界面。
* `manifest.json` — 集成元数据。
* `const.py` — 常量定义。
* `zhuhai_price_table.png` — 你上传的本地电价表截图。

---

## 🧩 安装方式（HACS）

1. 将此仓库添加为 HACS 自定义仓库。
2. 搜索 **Zhuhai Energy Price** 并安装。
3. 在 Home Assistant → 设置 → 设备与服务 → 添加集成 → 搜索「珠海电价」。
4. 按界面提示完成电价参数设置。

---

## ⚙️ 可配置参数（config_flow）

| 参数      | 说明                  |
| ------- | ------------------- |
| 尖时电价    | 元/度                 |
| 峰时电价    | 元/度                 |
| 平时电价    | 元/度                 |
| 谷时电价    | 元/度                 |
| 阶梯 1 电价 | 用电 ≤ 阶梯 1 上限（度）时的单价 |
| 阶梯 2 电价 | 用电 ≤ 阶梯 2 上限（度）时的单价 |
| 阶梯 3 电价 | 超过阶梯 2 后使用          |
| 电表实体    | 获取实时当日/当月用电量        |

支持动态电价模式（优先分时电价，再用阶梯价补充）。

---

## 📊 已提供的传感器

| 传感器 ID                        | 功能                      |
| ----------------------------- | ----------------------- |
| `sensor.zhuhai_current_price` | 当前时间应使用的电价（自动判断尖/峰/平/谷） |
| `sensor.zhuhai_daily_cost`    | 根据当日实际用电计算费用            |
| `sensor.zhuhai_monthly_cost`  | 根据当月累计用电量自动计算阶梯电价费用     |

均可直接加入 Energy Dashboard。

---

## 🖼 电价表

下图为集成使用的基础电价（你上传的原图已封装进项目）：

*(本地文件：`zhuhai_price_table.png`)*

---

## ❤️ 反馈与改进

如需：

* 自动对接某型号电表
* 自定义更多时段
* 加入实时电力公司 API（如果你有）

都可以告诉我，我能继续为你扩展。
